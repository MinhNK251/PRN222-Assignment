    @page "{id:int}"
    @using AirWaterStore.Web.Helper
    @model AirWaterStore.Web.Pages.CommissionRequests.DetailsModel
    @{
        ViewData["Title"] = "Request Details";
    }

<a asp-page="./Index" class="btn btn-secondary mb-3">
    <i class="fas fa-arrow-left"></i> Back
</a>

<div class="container mt-4">
    <h2>Game Request: @Model.Request.GameTitle</h2>
    <p><strong>Requested By:</strong> @Model.CreatorUsername</p>
    <p><strong>Description:</strong> @(Model.Request.Description ?? "No description")</p>
    <p><strong>Status:</strong> @Model.Request.Status</p>
    <p><strong>Upvotes:</strong> @(Model.Request.Upvotes ?? 0)</p>

    <!-- Upvote toggle -->
    @if (Model.IsAuthenticated())
    {
        <form method="post" asp-page-handler="Upvote">
            <input type="hidden" name="requestId" value="@Model.Request.CommissionRequestId" />
            <button type="submit" class="btn @(Model.AlreadyUpvoted ? "btn-danger" : "btn-success")">
                @(Model.AlreadyUpvoted ? "👎 Remove Upvote" : "👍 Upvote This Request")
            </button>
        </form>
    }
    else
    {
        <p><a asp-page="/Login">Login</a> to upvote this request.</p>
    }

    <hr />

    <!-- Edit/Delete buttons always shown -->
    <a asp-page="./Edit" asp-route-id="@Model.Request.CommissionRequestId"
       class="btn btn-primary @((Model.Request.UserId != Model.GetCurrentUserId() && !Model.IsStaff()) ? "disabled" : "")"
       title="Only the creator or staff can edit">
        ✏ Edit
    </a>
    <a asp-page="./Delete" asp-route-id="@Model.Request.CommissionRequestId"
       class="btn btn-danger @((Model.Request.UserId != Model.GetCurrentUserId() && !Model.IsStaff()) ? "disabled" : "")"
       title="Only the creator or staff can delete">
        🗑 Delete
    </a>

    <!-- Suggest new request (only if not the creator) -->
    @* @if (Model.IsAuthenticated() && Model.Request.UserId != Model.GetCurrentUserId()) *@
    @* { *@
    @*     <h4>Suggest Another Game</h4> *@
    @*     <form method="post" asp-page-handler="Create"> *@
    @*         <div class="mb-3"> *@
    @*             <label asp-for="NewRequest.GameTitle" class="form-label"></label> *@
    @*             <input asp-for="NewRequest.GameTitle" class="form-control" /> *@
    @*             <span asp-validation-for="NewRequest.GameTitle" class="text-danger"></span> *@
    @*         </div> *@
    @*         <div class="mb-3"> *@
    @*             <label asp-for="NewRequest.ExpectedPrice" class="form-label"></label> *@
    @*             <input asp-for="NewRequest.ExpectedPrice" class="form-control" /> *@
    @*             <span asp-validation-for="NewRequest.ExpectedPrice" class="text-danger"></span> *@
    @*         </div> *@
    @*         <div class="mb-3"> *@
    @*             <label asp-for="NewRequest.Description" class="form-label"></label> *@
    @*             <textarea asp-for="NewRequest.Description" class="form-control"></textarea> *@
    @*             <span asp-validation-for="NewRequest.Description" class="text-danger"></span> *@
    @*         </div> *@
    @*         <button type="submit" class="btn btn-primary">Submit Suggestion</button> *@
    @*     </form> *@
    @* } *@
    @* else if (Model.IsAuthenticated()) *@
    @* { *@
    @*     <p class="text-muted">You created this request. Others may suggest additional games.</p> *@
    @* } *@
    @* else *@
    @* { *@
    @*     <p><a asp-page="/Login">Login</a> to suggest new requests.</p> *@
    @* } *@
</div>
